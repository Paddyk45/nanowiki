<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta content="NanoWIKI (https://github.com/Paddyk45/nanowiki)" name="generator">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Atkinson+Hyperlegible:ital,wght@0,400;0,700;1,400;1,700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/style.css">
    <title>Edit {{ title }} | {{ crate::INSTANCE_NAME }}</title>
    <script>
        async function onSubmit() {
            let contentTextArea = document.getElementById("content");
            let content = contentTextArea.value;
            let updateUrl = "/articles/" + encodeURIComponent("{{ title }}");
            let body = "content=" + encodeURIComponent(content) + "&pw=" + encodeURIComponent(document.getElementById("password").value);
            let res = await fetch(
                updateUrl, {
                method: "POST",
                    headers: {
                        "Content-Type": "application/x-www-form-urlencoded",
                    },
                body: body
            });
            if (res.ok) {
                window.location = "/articles/" + encodeURIComponent("{{ title }}");
            }
            else {
                let submitBtn = document.getElementById("submit")
                submitBtn.textContent = "Failed to submit"
            }
        }
    </script>
</head>
<body>
<h1 class="title">Edit {{ title }}</h1>
<label for="content">New content:</label>
<br>
<br>
    <textarea id="content" rows="20" cols="40">{{ body }}</textarea>
    <br>
    <button onclick="onSubmit()" id="submit">Submit</button>
{% if !crate::EDIT_PASSWORD.is_empty() %}
    <label>
        <input placeholder="Password" type="password" class="input" id="password">
    </label>
{% endif %}
</body>
</html>